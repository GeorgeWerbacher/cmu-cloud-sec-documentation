# AI Assistant

## Interactive Learning Support

Welcome to your Cloud Security course AI assistant, powered by Perplexity AI. This tool is designed to enhance your learning experience by providing immediate answers to your questions about cloud security concepts, technologies, and best practices.

## How It Works

The AI assistant integrates directly with the course content and can:

1. **Answer questions** about cloud security concepts
2. **Explain technical terms** in simple language
3. **Provide examples** to illustrate complex topics
4. **Reference relevant resources** from the course materials
5. **Guide you through problem-solving** approaches

## Using the Assistant

To interact with the AI assistant:

1. Type your question in the chat box below
2. The AI will analyze your question and search for the most relevant information
3. Review the response, which will include references to source materials
4. Ask follow-up questions to explore the topic further

## Example Questions

Here are some examples of questions you can ask:

- "What is the shared responsibility model in cloud security?"
- "Explain the principle of least privilege and how to implement it in AWS."
- "What are the key differences between security approaches in AWS, Azure, and GCP?"
- "How do I set up proper network segmentation in a cloud environment?"
- "What compliance requirements apply to healthcare data in the cloud?"

## Connect with Perplexity AI

For more comprehensive research and deeper exploration, you can also visit the full [Perplexity AI platform](https://perplexity.ai).

<div className="not-prose">
  <div id="perplexity-chat-container">
    Loading AI Chat Interface...
  </div>
</div>

<script>
  // This script will only run on the client-side
  document.addEventListener('DOMContentLoaded', function() {
    // Wait for React to be available (from Next.js)
    const interval = setInterval(() => {
      if (typeof React !== 'undefined' && typeof ReactDOM !== 'undefined') {
        clearInterval(interval);
        initializePerplexityChat();
      }
    }, 100);

    function initializePerplexityChat() {
      const container = document.getElementById('perplexity-chat-container');
      if (!container) return;

      // Create a basic UI with plain JavaScript
      container.innerHTML = `
        <div style="margin-top: 2rem; padding: 1.5rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; background-color: #f9fafb;">
          <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem;">Cloud Security AI Assistant</h3>
          
          <div id="chat-messages" style="padding: 1rem; background-color: white; border: 1px solid #d1d5db; border-radius: 0.5rem; margin-bottom: 1rem; min-height: 300px; max-height: 500px; overflow-y: auto;">
            <p style="color: #6b7280; font-style: italic;">Ask a question about cloud security to get started!</p>
          </div>
          
          <form id="chat-form" style="display: flex; align-items: center;">
            <input 
              id="query-input"
              type="text" 
              placeholder="Ask a question about cloud security..." 
              style="flex-grow: 1; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.5rem; margin-right: 0.5rem;"
            />
            <button 
              type="submit"
              style="padding: 0.5rem 1rem; background-color: #2563eb; color: white; border-radius: 0.5rem; border: none; cursor: pointer;"
            >
              Send
            </button>
          </form>
          
          <div style="margin-top: 1rem;">
            <p style="font-size: 0.75rem; color: #6b7280;">Powered by Perplexity AI</p>
            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem;">
              <button 
                class="quick-question"
                data-query="What is the shared responsibility model in cloud security?"
                style="font-size: 0.75rem; padding: 0.25rem 0.75rem; background-color: #e5e7eb; border-radius: 9999px; border: none; cursor: pointer;"
              >
                Shared responsibility model
              </button>
              <button 
                class="quick-question"
                data-query="Explain the principle of least privilege in AWS."
                style="font-size: 0.75rem; padding: 0.25rem 0.75rem; background-color: #e5e7eb; border-radius: 9999px; border: none; cursor: pointer;"
              >
                Principle of least privilege
              </button>
              <button 
                class="quick-question"
                data-query="How do I secure an S3 bucket?"
                style="font-size: 0.75rem; padding: 0.25rem 0.75rem; background-color: #e5e7eb; border-radius: 9999px; border: none; cursor: pointer;"
              >
                S3 bucket security
              </button>
            </div>
          </div>
        </div>
      `;

      // Chat history array
      let chatHistory = [];
      let isLoading = false;

      // Add event listener to the form
      const form = document.getElementById('chat-form');
      const input = document.getElementById('query-input');
      const messagesContainer = document.getElementById('chat-messages');

      // Quick question buttons
      const quickQuestionButtons = document.querySelectorAll('.quick-question');
      quickQuestionButtons.forEach(button => {
        button.addEventListener('click', () => {
          const query = button.getAttribute('data-query');
          input.value = query;
          sendMessage(query);
        });
      });

      // Form submission handler
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const query = input.value.trim();
        if (!query || isLoading) return;
        sendMessage(query);
      });

      // Function to send a message to the AI
      async function sendMessage(query) {
        if (isLoading) return;
        
        // Update UI to show user's message
        const newMessage = { role: 'user', content: query };
        chatHistory.push(newMessage);
        updateChatUI();
        
        // Clear input and show loading state
        input.value = '';
        isLoading = true;
        updateChatUI();
        
        try {
          const response = await fetch('/api/perplexity', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ query, context: 'cloud security course' }),
          });

          if (!response.ok) {
            throw new Error('Failed to fetch response');
          }

          const data = await response.json();
          
          // Add AI response to chat history
          chatHistory.push({ role: 'assistant', content: data.answer });
        } catch (error) {
          console.error('Error fetching AI response:', error);
          chatHistory.push({ 
            role: 'assistant', 
            content: 'I apologize, but I encountered an error processing your request. Please try again later.'
          });
        } finally {
          isLoading = false;
          updateChatUI();
        }
      }

      // Function to update the chat UI based on chat history
      function updateChatUI() {
        if (chatHistory.length === 0) {
          messagesContainer.innerHTML = `<p style="color: #6b7280; font-style: italic;">Ask a question about cloud security to get started!</p>`;
          return;
        }

        let html = '';
        chatHistory.forEach(message => {
          const isUser = message.role === 'user';
          html += `
            <div style="padding: 0.75rem; border-radius: 0.5rem; margin: ${isUser ? '0.5rem 0 0.5rem 2rem' : '0.5rem 2rem 0.5rem 0'}; background-color: ${isUser ? '#dbeafe' : '#f3f4f6'};">
              <p style="font-size: 0.75rem; font-weight: 600; color: #4b5563; margin-bottom: 0.25rem;">
                ${isUser ? 'You' : 'AI Assistant'}
              </p>
              <div style="font-size: 0.875rem;">${message.content}</div>
            </div>
          `;
        });

        if (isLoading) {
          html += `
            <div style="padding: 0.75rem; border-radius: 0.5rem; margin: 0.5rem 2rem 0.5rem 0; background-color: #f3f4f6;">
              <p style="font-size: 0.75rem; font-weight: 600; color: #4b5563; margin-bottom: 0.25rem;">AI Assistant</p>
              <div style="font-size: 0.875rem;">Thinking...</div>
            </div>
          `;
        }

        messagesContainer.innerHTML = html;
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
      }
    }
  });
</script>
